
	SELECT NOME, QNTDE_ALUNOS
		FROM (SELECT CATEGORIA.NOME as categoria, 
			  COUNT(ALUNO_CURSO.ALUNO_ID) AS NUMERO_CURSOS
			FROM CATEGORIA
				 JOIN CURSO
					ON CATEGORIA.ID = CURSO.CATEGORIA_ID
				 JOIN ALUNO_CURSO
					ON CURSO.ID = ALUNO_CURSO.CURSO_ID
			GROUP BY 1 ORDER BY NUMERO_CURSOS DESC) AS CATEGORIA_CURSOS
		WHERE QNTDE_ALUNOS >= 3 
		
CREATE  VIEW vw_cursos_por_categoria
    AS SELECT CATEGORIA.NOME as categoria, 
			  COUNT(ALUNO_CURSO.ALUNO_ID) AS NUMERO_CURSOS
			FROM CATEGORIA
				 JOIN CURSO
					ON CATEGORIA.ID = CURSO.CATEGORIA_ID
				 JOIN ALUNO_CURSO
					ON CURSO.ID = ALUNO_CURSO.CURSO_ID
			GROUP BY 1 ORDER BY NUMERO_CURSOS DESC
			
SELECT * FROM VW_CURSOS_POR_CATEGORIA WHERE NUMERO_CURSOS >=3


CREATE VIEW vw_cursos_programacao 
	AS SELECT nome 
		FROM CURSO 
	WHERE CATEGORIA_ID = 2
	
SELECT * FROM vw_cursos_programacao where nome = 'PHP';

SELECT categoria.id AS CATEGORIA_ID, VW_CURSOS_POR_CATEGORIA.* FROM VW_CURSOS_POR_CATEGORIA
	JOIN CATEGORIA on categoria.nome = VW_CURSOS_POR_CATEGORIA.categoria
